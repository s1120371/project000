<!DOCTYPE html>
<html lang="zh-Hant">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>健康管家 Health Tracker</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Noto Sans TC', sans-serif;
    }

    body {
      background-color: #f7f9fc;
      color: #333;
      line-height: 1.6;
    }

    .container {
      width: 90%;
      max-width: 1000px;
      margin: 0 auto;
    }

    header {
      background-color: #4CAF50;
      color: white;
      padding: 15px 0;
    }

    header .container {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    header nav a {
      color: white;
      margin-left: 20px;
      text-decoration: none;
      font-weight: bold;
    }

    header nav a:hover {
      text-decoration: underline;
    }

    .top-function-nav {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      background: #fff;
      padding: 15px 0;
      gap: 20px;
      border-bottom: 1px solid #ddd;
    }

    .top-function-nav a {
      text-decoration: none;
      color: #4CAF50;
      font-size: 1.1rem;
      font-weight: bold;
      transition: color 0.2s;
    }

    .top-function-nav a:hover {
      color: #2e7d32;
    }

    .hero {
      background: #e8f5e9;
      padding: 60px 0;
      text-align: center;
    }

    footer {
      width: 100%;
      background-color: #f1f1f1;
      color: #666;
      text-align: center;
      padding: 20px 0;
      font-size: 0.9rem;
      margin-top: 40px;
    }

    .info-box {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      border: 1px solid #ddd;
    }

    .info-box p {
      margin-bottom: 10px;
    }

    /*新聞*/
    .news-preview {
      padding: 40px 0;
      background-color: #f4f9ff;
      text-align: left;
      margin-bottom: 40px;
    }

    .news-preview h3 {
      font-size: 2rem;
      color: #2e5caa;
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 20px;
      text-align: center;
    }

    .news-list {
      display: flex;
      flex-direction: column;
      gap: 20px;
      align-items: center;
    }

    .news-item {
      background: #ffffff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      transition: transform 0.3s, box-shadow 0.3s;
      position: relative;
      overflow: hidden;
      border-left: 5px solid #2e5caa;

      width: 100%;
      /* 在小螢幕下可以滿版 */
      max-width: 1000px;
      /* ✅ 限制最大寬度 */
      margin: 0 auto;
      /* ✅ 強制置中（保險做法） */
      text-align: left;
      /* 文字保持靠左 */
    }

    .news-item:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
    }

    .news-item h4 {
      font-size: 1.2rem;
      margin-bottom: 8px;
      color: #2e5caa;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .news-item h4::before {
      content: "🥬";
      font-size: 1.4rem;
      margin-right: 8px;
    }

    .news-item p {
      font-size: 0.95rem;
      color: #555;
      margin-bottom: 12px;
      line-height: 1.6;
    }

    .news-btn {
      display: inline-block;
      background-color: #2e5caa;
      color: #ffffff;
      padding: 8px 16px;
      font-size: 0.9rem;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s;
      text-decoration: none;
      font-weight: bold;
      text-align: center;
    }

    .news-btn:hover {
      background-color: #1f3e7a;
    }

    .news-btn:focus {
      outline: none;
      box-shadow: 0 0 0 4px rgba(46, 92, 170, 0.2);
    }


    .news-preview h3 {
      font-size: 2rem;
      color: #2e5caa;
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 20px;
      text-align: center;
    }

    .hero h3 {
      font-size: 2rem;
      margin-bottom: 10px;
    }

    .features h3 {
      font-size: 1.8rem;
      margin-bottom: 20px;
    }

    .function-menu h3 {
      font-size: 1.8rem;
      margin-bottom: 20px;
      text-align: center;
    }
  </style>
</head>

<body>
  <header>
    <div class="container">
      <h1>健康管家</h1>
      <nav>
        <span id="user-identity" style="margin-right: 20px;"></span>
        <span id="login-links"><a href="/login">登入 / 註冊</a></span>
        <span id="auth-links" style="display: none;">
          <a href="/edit-profile">個人資料</a>
          <a href="#" id="logoutBtn">登出</a>
        </span>
      </nav>
    </div>
  </header>

  <nav class="top-function-nav">
    <!--<a href="#map">📍 地點紀錄</a>-->
    <a href="/nutrition">🍱 營養分析</a>
    <a href="/">❤️ 健康建議</a>
    <a href="/achievements">💪 我的成就</a>
    <!--<a href="#">📊 趨勢統計</a>-->
    <!--<a href="#">🤝 社群挑戰</a>-->
    <a href="/bmi">📐 BMI 計算</a>
  </nav>

  <section class="hero">
    <div class="container">
      <h2 id="welcome-title">讓飲食更智慧，健康看得見</h2>
      <p>結合 AI ，提供全面性的健康飲食分析。</p>
    </div>
  </section>

  <section class="user-data container">
    <h2>👤 使用者個人資料</h2>
    <div id="userInfo" class="info-box" style="display:none;">
      <p><strong>帳號：</strong><span id="username"></span></p>
      <p><strong>姓名：</strong><span id="fullname"></span></p>
      <p><strong>性別：</strong><span id="gender"></span></p>
      <p><strong>生日：</strong><span id="birthdate"></span></p>
      <p><strong>飲食習慣：</strong><span id="diet"></span></p>
      <p><strong>健康目標：</strong><span id="goal"></span></p>
      <p><strong>過敏源：</strong><span id="allergens"></span></p>
    </div>
  </section>

  <!--   <section class="map-preview container">
    <h2>地圖預覽</h2>
    <div id="map"></div>
  </section> -->
  <section class="news-preview">
    <div class="container">
      <h3>📢 相關新聞</h3>
      <div class="news-list">
        <div class="news-item">
          <h4>正餐時間外老覺得餓？恐是蛋白質不足 營養師教簡單補足擺脫疲勞</h4>
          <p>蛋白質是維持健康與代謝的重要營養素，攝取不足易感疲憊與飢餓。專家建議每餐攝取30公克蛋白質，從早餐起搭配乳製品、堅果等天然食材，有助提升飽足感與修復力，維持身體活力。</p>
          <a href="https://udn.com/news/story/7266/8738067" class="news-btn">閱讀全文</a>
        </div>
        <div class="news-item">
          <h4>養生女自製健康早餐 「1吃法」險得糖尿病！很多人中</h4>
          <p>五穀粉雖健康，但磨粉後易轉為「糖水」，恐導致肥胖與血糖飆升。建議選原型穀物、控制份量，搭配蛋白質與好油脂，避免天天大量飲用。</p>
          <a href="#" class="news-btn">閱讀全文</a>
        </div>
        <div class="news-item">
          <h4>減肥失敗真相曝光！蛋白質吃不夠才是主因</h4>
          <p>研究指出，蛋白質攝取不足會導致過度進食、熱量超標，反而變胖。減重時應確保飲食中蛋白質達15%，提升飽足感、穩定食慾，才能有效控制體重，避免高脂與高糖飲食。</p>
          <a href="https://tw.news.yahoo.com/%E6%B8%9B%E8%82%A5%E5%A4%B1%E6%95%97%E7%9C%9F%E7%9B%B8%E6%9B%9D%E5%85%89-%E8%9B%8B%E7%99%BD%E8%B3%AA%E5%90%83%E4%B8%8D%E5%A4%A0%E6%89%8D%E6%98%AF%E4%B8%BB%E5%9B%A0-002333952.html"
            class="news-btn">閱讀全文</a>
        </div>
      </div>
    </div>
    <footer>
      <p>&copy; 2025 健康管家 Health Tracker</p>
    </footer>

    <!-- Firebase 認證 + Firestore -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
      import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-auth.js";
      import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyCCNPhST7sScxFdSZJ6-NbxKgqrSYOzes4",
        authDomain: "project-1c574.firebaseapp.com",
        projectId: "project-1c574",
        storageBucket: "project-1c574.appspot.com",
        messagingSenderId: "88492956577",
        appId: "1:88492956577:web:d7e5bf270544d34ebc09e0"
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const db = getFirestore(app);

      const userIdentity = document.getElementById("user-identity");
      const authLinks = document.getElementById("auth-links");
      const loginLinks = document.getElementById("login-links");
      const logoutBtn = document.getElementById("logoutBtn");
      const welcomeTitle = document.getElementById("welcome-title");
      const userInfoBox = document.getElementById("userInfo");

      onAuthStateChanged(auth, async (user) => {
        if (!user) {
          userIdentity.textContent = "";
          authLinks.style.display = "none";
          loginLinks.style.display = "inline";
          welcomeTitle.textContent = "尚未登入，將導向登入頁...";
          setTimeout(() => window.location.href = "/login", 2000);
          return;
        }

        authLinks.style.display = "inline";
        loginLinks.style.display = "none";

        const docRef = doc(db, "users", user.uid);
        const docSnap = await getDoc(docRef);

        if (docSnap.exists()) {
          const data = docSnap.data();

          // 👇 歡迎語與右上角名稱都顯示 username（找不到就 fallback 成 email）
          const username = data.username;
          welcomeTitle.textContent = `👋 歡迎回來，${username}`;
          userIdentity.textContent = username;

          userInfoBox.style.display = "block";
          document.getElementById("username").textContent = data.username || "未填寫";
          document.getElementById("fullname").textContent = data.fullname || "未填寫";
          document.getElementById("gender").textContent = data.gender || "未填寫";
          document.getElementById("birthdate").textContent = data.birthdate || "未填寫";
          document.getElementById("diet").textContent = data.diet || "未填寫";
          document.getElementById("goal").textContent = data.goal || "未填寫";
          document.getElementById("allergens").textContent = (data.allergens || []).join(", ") || "無";
        } else {
          userInfoBox.innerHTML = "<p>⚠️ 尚未填寫個人資料</p>";
        }
      });

      logoutBtn?.addEventListener("click", async () => {
        await signOut(auth);
        window.location.href = "/login";
      });
    </script>

    <!-- Google Map -->
    <!--   <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap" async defer></script>
  <script>
    function initMap() {
      const defaultLocation = { lat: 25.0330, lng: 121.5654 }; // 台北市
      const map = new google.maps.Map(document.getElementById("map"), {
        zoom: 12,
        center: defaultLocation,
      });
    }
  </script> -->
</body>


</html>
